<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jailbreak Trading Information</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://i.imghippo.com/files/rX5378Ok.png">
    <style>
        /* Universal Box-Sizing for consistent layout */
        * {
            box-sizing: border-box;
        }

        /* Basic Reset and Font */
        body {
            margin: 0;
            padding: 0;
            font-family: "SF Pro Text", "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            background-color: #121212; /* Darkest Grey background as requested */
            background-image: url('https://i.imghippo.com/files/ZKX3827pMU.jpg'); /* Space background image */
            background-size: cover; /* Cover the entire viewport */
            background-attachment: fixed; /* Keep background fixed while scrolling */
            background-position: center; /* Center the background image */
            color: #ffffff; /* White text for general content */
            min-height: 100vh; /* Ensure body takes full viewport height */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 0; /* Vertical padding */
        }

        /* Combined Home/About Section */
        #home-about-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            max-width: 60rem;
            width: 90%;
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            margin-top: 2rem;
            border: 1px solid #ffffff; /* White border */
            margin-bottom: 2rem;
        }

        #home-about-section h1 { /* Welcome title */
            font-size: 3.5rem;
            color: #ffffff; /* White title */
            margin-bottom: 1.5rem;
            text-shadow: 0px 0px 10px rgba(255, 255, 255, 0.8); /* White glow */
        }

        #home-about-section .welcome-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #e2e8f0;
            margin-bottom: 1.5rem;
        }

        #home-about-section h2 { /* About title */
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White title */
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        #home-about-section .about-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #e2e8f0;
            margin-bottom: 0.5rem;
        }

        #home-about-section .about-text:last-child {
            margin-bottom: 0;
        }

        /* Category Buttons Container */
        #category-buttons {
            margin-bottom: 1.5rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .category-button {
            background-color: transparent; /* Default transparent background */
            color: #ffffff; /* White text */
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #ffffff; /* White border */
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }

        .category-button:hover {
            background-color: rgba(255, 255, 255, 0.1); /* Slight white tint on hover */
            transform: translateY(-2px);
        }

        .category-button.active {
            background-color: #ffffff; /* White square active */
            color: #101010; /* Very dark grey text for active button */
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.5); /* White focus ring */
        }

        /* Search Bar Styling (General) */
        .search-bar {
            width: 90%;
            max-width: 30rem;
            padding: 0.75rem 1rem;
            margin-bottom: 2rem;
            border-radius: 0.75rem; /* Increased border-radius for softer look */
            border: 1px solid #ffffff; /* White border */
            background-color: #1f1f1f; /* Darker Grey background */
            color: #ffffff; /* White text */
            font-size: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .search-bar::placeholder {
            color: #cbd5e0;
            opacity: 0.7;
        }

        .search-bar:focus {
            outline: none;
            border-color: #ffffff; /* White on focus */
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.5); /* White focus ring */
        }

        /* Main Heading for Categories */
        .category-heading {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 2.5rem;
            color: #ffffff; /* White title */
            text-align: center;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            text-shadow: 0px 0px 8px rgba(255, 255, 255, 0.7); /* White glow */
        }

        /* Demand Explainer Section */
        #demand-explainer {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem;
            background-color: #2a2a2a; /* Lighter grey for explainer background */
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 2rem;
            margin-bottom: 2rem;
            max-width: 60rem;
            width: 90%;
            border: 1px solid #ffffff; /* White border */
        }

        .demand-explainer-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #e2e8f0;
            padding: 0.4rem 0.8rem;
            border-radius: 0.5rem;
            background-color: #1f1f1f; /* Darker Grey for individual items */
        }

        .demand-explainer-circle {
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
        }

        /* Item Container (applies to both main display and calculator browse) */
        #item-container, #calculator-item-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem; /* Consistent gap between cards */
            max-width: 80rem; /* Allows enough space for multiple columns */
            margin-left: auto;
            margin-right: auto;
            padding: 0 1rem;
        }

        /* Individual Item Card Styling */
        .item-card {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            flex-grow: 0;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            color: #ffffff;
            transition: transform 0.2s ease-in-out;
            border: 1px solid #ffffff; /* White border */
            position: relative;
            overflow: hidden;
        }

        /* Responsive width for item-card */
        @media (min-width: 1025px) { /* Desktop: 3 columns for main display */
            #item-container .item-card {
                flex-basis: calc(33.333% - 1rem); /* 1.5rem gap * 2 gaps / 3 items = 1rem */
                width: auto; /* Ensure flex-basis takes precedence */
            }
            #calculator-item-container .item-card { /* Calculator browse: 4 columns */
                flex-basis: calc(25% - 1.125rem); /* 1.5rem gap * 3 gaps / 4 items = 1.125rem */
                width: auto; /* Remove explicit width */
            }
        }
        @media (min-width: 769px) and (max-width: 1024px) { /* Tablet: 2 columns for main, 3 for calculator browse */
            #item-container .item-card {
                flex-basis: calc(50% - 0.75rem); /* 1.5rem gap * 1 gap / 2 items = 0.75rem */
                width: auto; /* Remove explicit width */
            }
            #calculator-item-container .item-card { /* Calculator browse: 3 columns */
                flex-basis: calc(33.333% - 1rem);
                width: auto; /* Remove explicit width */
            }
        }
        @media (max-width: 768px) { /* Mobile: 1 column for both */
            .item-card {
                flex-basis: 90%; /* Nearly full width on mobile */
                width: auto; /* Remove explicit width */
                max-width: 20rem; /* Prevent single card from getting too wide */
            }
            #calculator-item-container .item-card {
                flex-basis: 90%;
                width: auto; /* Remove explicit width */
                max-width: 18rem;
            }
        }

        .item-card:hover {
            transform: translateY(-5px);
        }

        /* Card Title (Item Name) */
        .item-card h2 {
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White title */
            margin-bottom: 0.5rem;
            text-align: center;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Value Blocks (Current Value, Duped Value) */
        .value-block {
            background-color: #2a2a2a; /* Lighter Grey text background */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .value-block-label {
            font-size: 1rem;
            font-weight: 600;
            color: #cbd5e0;
        }

        .value-block-amount {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ffffff;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Demand Section */
        .demand-block {
            background-color: #2a2a2a; /* Lighter Grey text background */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .demand-label {
            font-size: 1rem;
            font-weight: 600;
            color: #cbd5e0;
        }

        .demand-level-pill {
            font-size: 0.9rem;
            font-weight: bold;
            padding: 0.3rem 0.7rem;
            border-radius: 9999px;
            color: #101010; /* Very dark grey text for demand pills */
        }

        /* Specific Demand Level Colors (kept as is) */
        .demand-level-close-to-none { background-color: #6B7280; }
        .demand-level-very-low { background-color: #EF4444; }
        .demand-level-low { background-color: #F97316; }
        .demand-level-medium { background-color: #F59E0B; }
        .demand-level-decent { background-color: #22C55E; }
        .demand-level-high { background-color: #3B82F6; }
        .demand-level-very-high { background-color: #8B5CF6; }
        .demand-level-extremely-high { background-color: #EC4899; }
        .demand-level-unknown { background-color: #6B7280; }

        /* Separator Line */
        .separator {
            border-top: 1px solid #303030; /* Lighter grey */
            margin: 1rem 0;
        }

        /* Condensed Details Section */
        .details-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.3rem 0.75rem;
            font-size: 0.75rem;
            color: #e2e8f0;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .detail-label {
            font-weight: 600;
            color: #cbd5e0;
            margin-right: 0.5rem;
            flex-shrink: 0;
        }

        .detail-value {
            text-align: right;
            word-break: break-word;
            font-weight: normal;
            font-family: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Avoided Indicator - Simplified Circle */
        .avoided-indicator {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            z-index: 10;
        }

        .avoided-indicator.avoided-true {
            background-color: #ef4444; /* Red */
        }
        .avoided-indicator.avoided-slightly {
            background-color: #f97316; /* Orange/Yellow */
        }

        /* Trading Content Section (initially hidden) */
        .trading-content-section {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Discord Button (Top Right) */
        #discord-button-top {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            background-color: #5865F2; /* Discord Brand Color */
            border: none;
            border-radius: 50%;
            width: 3.5rem;
            height: 3.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
            z-index: 1000;
        }

        #discord-button-top:hover {
            background-color: #4752C4;
            transform: translateY(-3px);
        }

        #discord-button-top img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }


        /* Calculator Section Styling */
        #calculator-section {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 80rem;
            padding: 2rem 1rem;
            box-sizing: border-box;
        }

        .calculator-header {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 2.5rem;
            color: #ffffff; /* White title */
            text-align: center;
            text-shadow: 0px 0px 8px rgba(255, 255, 255, 0.7); /* White glow */
        }

        .trade-area-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            width: 100%;
            margin-bottom: 1rem;
        }

        .trade-area {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            width: 100%;
            max-width: 35rem;
            border: 1px solid #ffffff; /* White border */
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .trade-area-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e2e8f0;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .selected-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            min-height: 5rem;
            border: 1px dashed #2a2a2a; /* Lighter grey dashed border */
            border-radius: 0.5rem;
            padding: 0.75rem;
            align-content: flex-start;
        }

        .selected-item-pill {
            background-color: #2a2a2a; /* Lighter Grey text background */
            color: #ffffff;
            padding: 0.4rem 0.7rem;
            border-radius: 9999px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .selected-item-pill .remove-item-btn {
            background: none;
            border: none;
            color: #e2e8f0;
            font-size: 1rem;
            cursor: pointer;
            padding: 0;
            margin-left: 0.3rem;
            line-height: 1;
        }

        .trade-total {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ffffff; /* White total text */
            text-align: right;
            margin-top: 1rem;
        }

        /* Value Difference Section */
        #value-difference-section {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1rem 1.5rem;
            width: 100%;
            max-width: 72rem;
            margin-bottom: 2rem;
            border: 1px solid #ffffff; /* White border */
            text-align: center;
        }

        #value-difference-section .difference-label {
            font-size: 1.25rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 0.5rem;
        }

        #value-difference-section .difference-amount {
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White default color */
        }

        /* Calculator actions buttons (remains orange) */
        .calculator-actions button {
            background-color: #f97316;
            color: #101010; /* Darker text for orange button */
            /* ... other styles remain ... */
        }

        /* Calculator browse section buttons (remains light blue) */
        .calculator-item-actions button {
            background-color: #63b3ed;
            color: #101010; /* Darker text for blue button */
            /* ... other styles remain ... */
        }

        /* Responsive adjustments */
        @media (min-width: 1025px) { /* Desktop: 3 columns for main display */
            #item-container .item-card {
                flex-basis: calc(33.333% - 1rem); /* 1.5rem gap * 2 gaps / 3 items = 1rem */
            }
            #calculator-item-container .item-card { /* Calculator browse: 4 columns */
                flex-basis: calc(25% - 1.125rem); /* 1.5rem gap * 3 gaps / 4 items = 1.125rem */
            }
        }
        @media (min-width: 769px) and (max-width: 1024px) { /* Tablet: 2 columns for main, 3 for calculator browse */
            #item-container .item-card {
                flex-basis: calc(50% - 0.75rem); /* 1.5rem gap * 1 gap / 2 items = 0.75rem */
            }
            #calculator-item-container .item-card { /* Calculator browse: 3 columns */
                flex-basis: calc(33.333% - 1rem);
            }
        }
        @media (max-width: 768px) { /* Mobile: 1 column for both */
            .item-card {
                flex-basis: 90%; /* Nearly full width on mobile */
                max-width: 20rem; /* Prevent single card from getting too wide */
            }
            #calculator-item-container .item-card {
                flex-basis: 90%;
                max-width: 18rem;
            }
        }

        .item-card:hover {
            transform: translateY(-5px);
        }

        /* Card Title (Item Name) */
        .item-card h2 {
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White title */
            margin-bottom: 0.5rem;
            text-align: center;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Value Blocks (Current Value, Duped Value) */
        .value-block {
            background-color: #2a2a2a; /* Lighter Grey text background */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .value-block-label {
            font-size: 1rem;
            font-weight: 600;
            color: #cbd5e0;
        }

        .value-block-amount {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ffffff;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Demand Section */
        .demand-block {
            background-color: #2a2a2a; /* Lighter Grey text background */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .demand-label {
            font-size: 1rem;
            font-weight: 600;
            color: #cbd5e0;
        }

        .demand-level-pill {
            font-size: 0.9rem;
            font-weight: bold;
            padding: 0.3rem 0.7rem;
            border-radius: 9999px;
            color: #101010; /* Very dark grey text for demand pills */
        }

        /* Specific Demand Level Colors (kept as is) */
        .demand-level-close-to-none { background-color: #6B7280; }
        .demand-level-very-low { background-color: #EF4444; }
        .demand-level-low { background-color: #F97316; }
        .demand-level-medium { background-color: #F59E0B; }
        .demand-level-decent { background-color: #22C55E; }
        .demand-level-high { background-color: #3B82F6; }
        .demand-level-very-high { background-color: #8B5CF6; }
        .demand-level-extremely-high { background-color: #EC4899; }
        .demand-level-unknown { background-color: #6B7280; }

        /* Separator Line */
        .separator {
            border-top: 1px solid #303030; /* Lighter grey */
            margin: 1rem 0;
        }

        /* Condensed Details Section */
        .details-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.3rem 0.75rem;
            font-size: 0.75rem;
            color: #e2e8f0;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .detail-label {
            font-weight: 600;
            color: #cbd5e0;
            margin-right: 0.5rem;
            flex-shrink: 0;
        }

        .detail-value {
            text-align: right;
            word-break: break-word;
            font-weight: normal;
            font-family: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Avoided Indicator - Simplified Circle */
        .avoided-indicator {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            z-index: 10;
        }

        .avoided-indicator.avoided-true {
            background-color: #ef4444; /* Red */
        }
        .avoided-indicator.avoided-slightly {
            background-color: #f97316; /* Orange/Yellow */
        }

        /* Trading Content Section (initially hidden) */
        .trading-content-section {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Discord Button (Top Right) */
        #discord-button-top {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            background-color: #5865F2; /* Discord Brand Color */
            border: none;
            border-radius: 50%;
            width: 3.5rem;
            height: 3.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
            z-index: 1000;
        }

        #discord-button-top:hover {
            background-color: #4752C4;
            transform: translateY(-3px);
        }

        #discord-button-top img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }


        /* Calculator Section Styling */
        #calculator-section {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 80rem;
            padding: 2rem 1rem;
            box-sizing: border-box;
        }

        .calculator-header {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 2.5rem;
            color: #ffffff; /* White title */
            text-align: center;
            text-shadow: 0px 0px 8px rgba(255, 255, 255, 0.7); /* White glow */
        }

        .trade-area-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            width: 100%;
            margin-bottom: 1rem;
        }

        .trade-area {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            width: 100%;
            max-width: 35rem;
            border: 1px solid #ffffff; /* White border */
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .trade-area-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e2e8f0;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .selected-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            min-height: 5rem;
            border: 1px dashed #2a2a2a; /* Lighter grey dashed border */
            border-radius: 0.5rem;
            padding: 0.75rem;
            align-content: flex-start;
        }

        .selected-item-pill {
            background-color: #2a2a2a; /* Lighter Grey text background */
            color: #ffffff;
            padding: 0.4rem 0.7rem;
            border-radius: 9999px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .selected-item-pill .remove-item-btn {
            background: none;
            border: none;
            color: #e2e8f0;
            font-size: 1rem;
            cursor: pointer;
            padding: 0;
            margin-left: 0.3rem;
            line-height: 1;
        }

        .trade-total {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ffffff; /* White total text */
            text-align: right;
            margin-top: 1rem;
        }

        /* Value Difference Section */
        #value-difference-section {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1rem 1.5rem;
            width: 100%;
            max-width: 72rem;
            margin-bottom: 2rem;
            border: 1px solid #ffffff; /* White border */
            text-align: center;
        }

        #value-difference-section .difference-label {
            font-size: 1.25rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 0.5rem;
        }

        #value-difference-section .difference-amount {
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White default color */
        }

        /* Calculator actions buttons (remains orange) */
        .calculator-actions button {
            background-color: #f97316;
            color: #101010; /* Darker text for orange button */
            /* ... other styles remain ... */
        }

        /* Calculator browse section buttons (remains light blue) */
        .calculator-item-actions button {
            background-color: #63b3ed;
            color: #101010; /* Darker text for blue button */
            /* ... other styles remain ... */
        }

        /* Responsive adjustments */
        @media (min-width: 1025px) { /* Desktop: 3 columns for main display */
            #item-container .item-card {
                flex-basis: calc(33.333% - 1rem); /* 1.5rem gap * 2 gaps / 3 items = 1rem */
            }
            #calculator-item-container .item-card { /* Calculator browse: 4 columns */
                flex-basis: calc(25% - 1.125rem); /* 1.5rem gap * 3 gaps / 4 items = 1.125rem */
            }
        }
        @media (min-width: 769px) and (max-width: 1024px) { /* Tablet: 2 columns for main, 3 for calculator browse */
            #item-container .item-card {
                flex-basis: calc(50% - 0.75rem); /* 1.5rem gap * 1 gap / 2 items = 0.75rem */
            }
            #calculator-item-container .item-card { /* Calculator browse: 3 columns */
                flex-basis: calc(33.333% - 1rem);
            }
        }
        @media (max-width: 768px) { /* Mobile: 1 column for both */
            .item-card {
                flex-basis: 90%; /* Nearly full width on mobile */
                max-width: 20rem; /* Prevent single card from getting too wide */
            }
            #calculator-item-container .item-card {
                flex-basis: 90%;
                max-width: 18rem;
            }
        }

        .item-card:hover {
            transform: translateY(-5px);
        }

        /* Card Title (Item Name) */
        .item-card h2 {
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White title */
            margin-bottom: 0.5rem;
            text-align: center;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Value Blocks (Current Value, Duped Value) */
        .value-block {
            background-color: #2a2a2a; /* Lighter Grey text background */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .value-block-label {
            font-size: 1rem;
            font-weight: 600;
            color: #cbd5e0;
        }

        .value-block-amount {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ffffff;
            font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Demand Section */
        .demand-block {
            background-color: #2a2a2a; /* Lighter Grey text background */
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .demand-label {
            font-size: 1rem;
            font-weight: 600;
            color: #cbd5e0;
        }

        .demand-level-pill {
            font-size: 0.9rem;
            font-weight: bold;
            padding: 0.3rem 0.7rem;
            border-radius: 9999px;
            color: #101010; /* Very dark grey text for demand pills */
        }

        /* Specific Demand Level Colors (kept as is) */
        .demand-level-close-to-none { background-color: #6B7280; }
        .demand-level-very-low { background-color: #EF4444; }
        .demand-level-low { background-color: #F97316; }
        .demand-level-medium { background-color: #F59E0B; }
        .demand-level-decent { background-color: #22C55E; }
        .demand-level-high { background-color: #3B82F6; }
        .demand-level-very-high { background-color: #8B5CF6; }
        .demand-level-extremely-high { background-color: #EC4899; }
        .demand-level-unknown { background-color: #6B7280; }

        /* Separator Line */
        .separator {
            border-top: 1px solid #303030; /* Lighter grey */
            margin: 1rem 0;
        }

        /* Condensed Details Section */
        .details-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.3rem 0.75rem;
            font-size: 0.75rem;
            color: #e2e8f0;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .detail-label {
            font-weight: 600;
            color: #cbd5e0;
            margin-right: 0.5rem;
            flex-shrink: 0;
        }

        .detail-value {
            text-align: right;
            word-break: break-word;
            font-weight: normal;
            font-family: "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        }

        /* Avoided Indicator - Simplified Circle */
        .avoided-indicator {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
            z-index: 10;
        }

        .avoided-indicator.avoided-true {
            background-color: #ef4444; /* Red */
        }
        .avoided-indicator.avoided-slightly {
            background-color: #f97316; /* Orange/Yellow */
        }

        /* Trading Content Section (initially hidden) */
        .trading-content-section {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Discord Button (Top Right) */
        #discord-button-top {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            background-color: #5865F2; /* Discord Brand Color */
            border: none;
            border-radius: 50%;
            width: 3.5rem;
            height: 3.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
            z-index: 1000;
        }

        #discord-button-top:hover {
            background-color: #4752C4;
            transform: translateY(-3px);
        }

        #discord-button-top img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }


        /* Calculator Section Styling */
        #calculator-section {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 80rem;
            padding: 2rem 1rem;
            box-sizing: border-box;
        }

        .calculator-header {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 2.5rem;
            color: #ffffff; /* White title */
            text-align: center;
            text-shadow: 0px 0px 8px rgba(255, 255, 255, 0.7); /* White glow */
        }

        .trade-area-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            width: 100%;
            margin-bottom: 1rem;
        }

        .trade-area {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            width: 100%;
            max-width: 35rem;
            border: 1px solid #ffffff; /* White border */
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .trade-area-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #e2e8f0;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .selected-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            min-height: 5rem;
            border: 1px dashed #2a2a2a; /* Lighter grey dashed border */
            border-radius: 0.5rem;
            padding: 0.75rem;
            align-content: flex-start;
        }

        .selected-item-pill {
            background-color: #2a2a2a; /* Lighter Grey text background */
            color: #ffffff;
            padding: 0.4rem 0.7rem;
            border-radius: 9999px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .selected-item-pill .remove-item-btn {
            background: none;
            border: none;
            color: #e2e8f0;
            font-size: 1rem;
            cursor: pointer;
            padding: 0;
            margin-left: 0.3rem;
            line-height: 1;
        }

        .trade-total {
            font-size: 1.25rem;
            font-weight: bold;
            color: #ffffff; /* White total text */
            text-align: right;
            margin-top: 1rem;
        }

        /* Value Difference Section */
        #value-difference-section {
            background-color: #1f1f1f; /* Darker Grey background */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1rem 1.5rem;
            width: 100%;
            max-width: 72rem;
            margin-bottom: 2rem;
            border: 1px solid #ffffff; /* White border */
            text-align: center;
        }

        #value-difference-section .difference-label {
            font-size: 1.25rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 0.5rem;
        }

        #value-difference-section .difference-amount {
            font-size: 1.75rem;
            font-weight: bold;
            color: #ffffff; /* White default color */
        }

        /* Calculator actions buttons (remains orange) */
        .calculator-actions button {
            background-color: #f97316;
            color: #101010; /* Darker text for orange button */
            /* ... other styles remain ... */
        }

        /* Calculator browse section buttons (remains light blue) */
        .calculator-item-actions button {
            background-color: #63b3ed;
            color: #101010; /* Darker text for blue button */
            /* ... other styles remain ... */
        }

        /* Responsive adjustments */
        @media (min-width: 1025px) { /* Desktop: 3 columns for main display */
            #item-container .item-card {
                flex-basis: calc(33.333% - 1rem); /* 1.5rem gap * 2 gaps / 3 items = 1rem */
            }
            #calculator-item-container .item-card { /* Calculator browse: 4 columns */
                flex-basis: calc(25% - 1.125rem); /* 1.5rem gap * 3 gaps / 4 items = 1.125rem */
            }
        }
        @media (min-width: 769px) and (max-width: 1024px) { /* Tablet: 2 columns for main, 3 for calculator browse */
            #item-container .item-card {
                flex-basis: calc(50% - 0.75rem); /* 1.5rem gap * 1 gap / 2 items = 0.75rem */
            }
            #calculator-item-container .item-card { /* Calculator browse: 3 columns */
                flex-basis: calc(33.333% - 1rem);
            }
        }
        @media (max-width: 768px) { /* Mobile: 1 column for both */
            .item-card {
                flex-basis: 90%; /* Nearly full width on mobile */
                max-width: 20rem; /* Prevent single card from getting too wide */
            }
            #calculator-item-container .item-card {
                flex-basis: 90%;
                max-width: 18rem;
            }
        }
    </style>
</head>
<body>

    <!-- Navigation Buttons -->
    <div id="category-buttons">
        <button id="home-button" class="category-button active">Home</button>
        <button id="all-button" class="category-button">All</button>
        <button id="vehicles-button" class="category-button">Vehicles</button>
        <button id="textures-button" class="category-button">Textures</button>
        <button id="rims-button" class="category-button">Rims</button>
        <button id="spoilers-button" class="category-button">Spoilers</button>
        <button id="hyperchromes-button" class="category-button">Hyperchromes</button>
        <button id="calculator-button" class="category-button">Calculator</button>
    </div>

    <!-- Combined Home and About Section -->
    <div id="home-about-section">
        <h1>Welcome to Jailbreak Stats!</h1>
        <p class="welcome-text">Your ultimate resource for up-to-date values, demand levels, and detailed information on all tradable items in Jailbreak. Navigate through different categories to find what you need, or use the search bar to quickly locate specific items.</p>

        <h2>About This Information</h2>
        <p class="about-text">This is a combination of values from Jailbreak Trade Network, Jailbreak Changelogs, Jailbreak Values, and Jailbreak Trade Core.</p>
        <p class="about-text">We purposefully did not include any forms of pictures or media to keep it easily accessible even with low/no internet connections for your own ease of access.</p>
        <p class="about-text">Always being updated by our professionals, however we do take community opinion largely into consideration when we change any values.</p>

        <!-- Demand Color Explainer - Moved to Home Section -->
        <div id="demand-explainer">
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-close-to-none"></span> Close to none</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-very-low"></span> Very Low</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-low"></span> Low</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-medium"></span> Medium</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-decent"></span> Decent</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-high"></span> High</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-very-high"></span> Very High</div>
            <div class="demand-explainer-item"><span class="demand-explainer-circle demand-level-extremely-high"></span> Extremely High</div>
        </div>
    </div>

    <!-- Trading Content Section (initially hidden) -->
    <div id="trading-content-section" class="trading-content-section">
        <input type="text" id="search-bar" class="search-bar" placeholder="Search items...">
        <h1 id="category-title" class="category-heading">Vehicle Collection</h1>

        <div id="item-container">
            <!-- Item cards will be injected here by JavaScript -->
        </div>
    </div>

    <!-- Calculator Section (initially hidden) -->
    <div id="calculator-section">
        <h1 class="calculator-header">Trade Calculator</h1>

        <div class="trade-area-container">
            <div class="trade-area" id="offering-area">
                <div class="trade-area-title">Offering (<span id="offering-count">0</span>/8)</div>
                <div class="selected-items-container" id="offering-items-container">
                    <!-- Selected offering items will be injected here -->
                </div>
                <div class="trade-total">Total: <span id="offering-total">$0</span></div>
            </div>

            <div class="trade-area" id="requesting-area">
                <div class="trade-area-title">Requesting (<span id="requesting-count">0</span>/8)</div>
                <div class="selected-items-container" id="requesting-items-container">
                    <!-- Selected requesting items will be injected here -->
                </div>
                <div class="trade-total">Total: <span id="requesting-total">$0</span></div>
            </div>
        </div>

        <!-- Value Difference Section -->
        <div id="value-difference-section">
            <div class="difference-label">Value Difference:</div>
            <div class="difference-amount" id="value-difference">$0</div>
        </div>

        <div class="calculator-actions">
            <button id="swap-sides-button" class="calculator-action-button">Swap Sides</button>
            <button id="clear-all-button" class="calculator-action-button">Clear All</button>
        </div>

        <div class="calculator-browse-section">
            <input type="text" id="calculator-search-bar" class="search-bar" placeholder="Search items to add...">
            <h2 class="category-heading">Browse Items</h2>
            <div id="calculator-item-container" class="item-container">
                <!-- Item cards for adding to calculator will be injected here -->
            </div>
        </div>
    </div>

    <!-- Discord Button (Top Right) -->
    <button id="discord-button-top">
        <img src="https://static.vecteezy.com/system/resources/previews/018/930/718/non_2x/discord-logo-discord-icon-transparent-free-png.png" alt="Discord Icon">
    </button>

    <!-- Custom Modal for Clean/Duped Value Selection -->
    <div id="value-selection-modal" class="modal-overlay">
        <div class="modal-content">
            <h3>Select the value for this item:</h3>
            <p id="modal-item-name"></p>
            <div class="modal-buttons">
                <button id="modal-clean-button" class="modal-button"></button>
                <button id="modal-duped-button" class="modal-button"></button>
            </div>
        </div>
    </div>

    <!-- Custom Message Box -->
    <div id="custom-message-box"></div>

    <script>
        // Data arrays for different categories
        const vehiclesData = [
            {
                name: "Torpedo",
                currentValue: "$49,000,000",
                dupedValue: "$42,500,000",
                demandLevel: "Decent",
                originalPrice: "$750,000",
                seasonReward: "OG S1/S2",
                distribution: "1,584",
                trades: "12,753",
                topSpeed: "395 MPH",
                hp: "75",
                avoided: "false"
            },
            {
                name: "Javelin",
                currentValue: "$44,000,000",
                dupedValue: "$48,000,000",
                demandLevel: "Decent",
                originalPrice: "$929,929",
                seasonReward: "—",
                distribution: "2,964",
                trades: "11,934",
                topSpeed: "390 MPH",
                hp: "75",
                avoided: "false"
            }
        ];

        const texturesData = [];
        const rimsData = [];
        const spoilersData = [];
        const hyperchromesData = [];

        // Combine all data into a single array and add a 'category' property for identification
        const allData = [
            ...vehiclesData.map(item => ({ ...item, category: "Vehicle" })),
            ...texturesData.map(item => ({ ...item, category: "Texture" })),
            ...rimsData.map(item => ({ ...item, category: "Rim" })),
            ...spoilersData.map(item => ({ ...item, category: "Spoiler" })),
            ...hyperchromesData.map(item => ({ ...item, category: "Hyperchrome" }))
        ];

        // Helper function to parse currency strings into numbers for sorting and calculation
        function parseCurrencyToNumber(currencyString) {
            if (!currencyString || currencyString === "N/A" || currencyString === "Unavailable" || currencyString === "—" || currencyString === "Unknown") {
                return 0; // Treat N/A or unavailable as 0 for sorting purposes
            }
            // Remove '$' and commas, then parse as integer
            return parseInt(currencyString.replace(/[$,]/g, ''), 10);
        }

        // Sort allData from most expensive to cheapest
        allData.sort((a, b) => {
            const valueA = parseCurrencyToNumber(a.currentValue);
            const valueB = parseCurrencyToNumber(b.currentValue);
            return valueB - valueA; // Descending order
        });


        // Get DOM elements
        const homeAboutSection = document.getElementById('home-about-section');
        const tradingContentSection = document.getElementById('trading-content-section');
        const calculatorSection = document.getElementById('calculator-section');

        const itemContainer = document.getElementById('item-container');
        const searchBar = document.getElementById('search-bar');
        const categoryTitle = document.getElementById('category-title');

        const homeButton = document.getElementById('home-button');
        const allButton = document.getElementById('all-button');
        const vehiclesButton = document.getElementById('vehicles-button');
        const texturesButton = document.getElementById('textures-button');
        const rimsButton = document.getElementById('rims-button');
        const spoilersButton = document.getElementById('spoilers-button');
        const hyperchromesButton = document.getElementById('hyperchromes-button');
        const calculatorButton = document.getElementById('calculator-button');

        const discordButtonTop = document.getElementById('discord-button-top');

        // Calculator specific DOM elements
        const offeringItemsContainer = document.getElementById('offering-items-container');
        const requestingItemsContainer = document.getElementById('requesting-items-container');
        const offeringTotalSpan = document.getElementById('offering-total');
        const requestingTotalSpan = document.getElementById('requesting-total');
        const offeringCountSpan = document.getElementById('offering-count');
        const requestingCountSpan = document.getElementById('requesting-count');
        const valueDifferenceSpan = document.getElementById('value-difference');
        const swapSidesButton = document.getElementById('swap-sides-button');
        const clearAllButton = document.getElementById('clear-all-button');
        const calculatorSearchBar = document.getElementById('calculator-search-bar');
        const calculatorItemContainer = document.getElementById('calculator-item-container');

        // Custom Modal elements
        const valueSelectionModal = document.getElementById('value-selection-modal');
        const modalItemName = document.getElementById('modal-item-name');
        const modalCleanButton = document.getElementById('modal-clean-button');
        const modalDupedButton = document.getElementById('modal-duped-button');
        const customMessageBox = document.getElementById('custom-message-box');


        // Calculator state
        let offeringItems = [];
        let requestingItems = [];
        const MAX_ITEMS_PER_SIDE = 8;

        let currentActiveData = vehiclesData; // Default to vehicles
        let currentCategoryName = "Vehicle"; // Default category title

        // Function to show a specific section and hide others
        function showSection(sectionId) {
            homeAboutSection.style.display = 'none';
            tradingContentSection.style.display = 'none';
            calculatorSection.style.display = 'none';

            if (sectionId === 'home-about-section') {
                homeAboutSection.style.display = 'flex';
            } else if (sectionId === 'trading-content-section') {
                tradingContentSection.style.display = 'flex';
            } else if (sectionId === 'calculator-section') {
                calculatorSection.style.display = 'flex';
                renderCalculatorBrowseItems(allData);
                updateCalculatorTotals();
            }
        }

        // Function to create a single item card (can be vehicle or texture or hyperchrome or rim or spoiler)
        // Added a 'mode' parameter to differentiate between main display and calculator browse
        function createItemCard(item, mode = 'display') {
            const card = document.createElement('div');
            card.id = `item-${item.name.replace(/\s/g, '-')}`;
            card.classList.add('item-card');

            // Add avoided indicator if applicable
            if (item.avoided && item.avoided !== "false") {
                const avoidedIndicator = document.createElement('div');
                avoidedIndicator.classList.add('avoided-indicator');
                if (item.avoided === "true") {
                    avoidedIndicator.classList.add('avoided-true');
                } else if (item.avoided === "slightly") {
                    avoidedIndicator.classList.add('avoided-slightly');
                }
                card.appendChild(avoidedIndicator);
            }

            const name = document.createElement('h2');
            name.textContent = item.name;
            card.appendChild(name);

            // Determine the correct label for current value based on the item's category
            let currentValueLabel;
            if (item.category === "Hyperchrome" || item.category === "Rim" || item.category === "Spoiler") {
                currentValueLabel = "Cash Value";
            } else {
                currentValueLabel = "Current Value";
            }

            const currentValueBlock = document.createElement('div');
            currentValueBlock.classList.add('value-block');
            currentValueBlock.innerHTML = `
                <span class="value-block-label">${currentValueLabel}</span>
                <span class="value-block-amount current-value-display">${item.currentValue}</span>
            `;
            card.appendChild(currentValueBlock);

            // Duped Value Block
            const dupedValueBlock = document.createElement('div');
            dupedValueBlock.classList.add('value-block');
            dupedValueBlock.innerHTML = `
                <span class="value-block-label">Duped Value</span>
                <span class="value-block-amount duped-value-display">${item.dupedValue}</span>
            `;
            card.appendChild(dupedValueBlock);

            // Demand Block
            const demandBlock = document.createElement('div');
            demandBlock.classList.add('demand-block');
            const demandLevelClass = item.demandLevel ? item.demandLevel.toLowerCase().replace(/\s/g, '-') : 'unknown';
            demandBlock.innerHTML = `
                <span class="demand-label">Demand</span>
                <span class="demand-level-pill demand-level-${demandLevelClass}">${item.demandLevel}</span>
            `;
            card.appendChild(demandBlock);

            // Only add separator and details section if not a Hyperchrome for main display
            // For calculator browse, we might omit these to keep cards smaller
            if (item.category !== "Hyperchrome" && mode === 'display') {
                const separator = document.createElement('div');
                separator.classList.add('separator');
                card.appendChild(separator);

                const detailsSection = document.createElement('div');
                detailsSection.classList.add('details-section');

                // Helper to create a detail item
                const createDetailItem = (label, value) => {
                    if (value === undefined || value === null || value === "—" || value === "❓ Not Available" || value === "N/A" || value === "Unknown") {
                        return null; // Don't create item if value is empty or specific placeholders
                    }
                    const itemDiv = document.createElement('div');
                    itemDiv.classList.add('detail-item');
                    itemDiv.innerHTML = `
                        <span class="detail-label">${label}:</span>
                        <span class="detail-value">${value}</span>
                    `;
                    return itemDiv;
                };

                // Dynamically add details based on item properties for Vehicles/Textures/Rims/Spoilers
                let acquisitionDetailItem = null;
                if (item.originalPrice) {
                    acquisitionDetailItem = createDetailItem("Original Price", item.originalPrice);
                } else if (item.obtainablePrice) {
                    acquisitionDetailItem = createDetailItem("Obtainable Price", item.obtainablePrice);
                } else if (item.testingAccess) {
                    acquisitionDetailItem = createDetailItem("Testing Access", item.testingAccess);
                } else if (item.vaultReward) {
                    acquisitionDetailItem = createDetailItem("Vault Reward", item.vaultReward);
                } else if (item.requirement) {
                    acquisitionDetailItem = createDetailItem("Requirement", item.requirement);
                }
                if (acquisitionDetailItem) detailsSection.appendChild(acquisitionDetailItem);

                let seasonInfoItem = null;
                if (item.seasonReward) {
                    seasonInfoItem = createDetailItem("Season Reward", item.seasonReward);
                } else if (item.seasonPass) {
                    seasonInfoItem = createDetailItem("Season Pass", item.seasonPass);
                }
                if (seasonInfoItem) detailsSection.appendChild(seasonInfoItem);

                const distributionItem = createDetailItem("Distribution", item.distribution);
                if (distributionItem) detailsSection.appendChild(distributionItem);

                const tradesItem = createDetailItem("Trades", item.trades);
                if (tradesItem) detailsSection.appendChild(tradesItem);

                if (item.topSpeed !== undefined) {
                    const topSpeedItem = createDetailItem("Top Speed", item.topSpeed);
                    if (topSpeedItem) detailsSection.appendChild(topSpeedItem);
                }
                if (item.hp !== undefined) {
                    const hpItem = createDetailItem("HP", item.hp);
                    if (hpItem) detailsSection.appendChild(hpItem);
                }

                if (item.collectorRarity !== undefined) {
                    const collectorRarityItem = createDetailItem("Collector Rarity", item.collectorRarity);
                    if (collectorRarityItem) detailsSection.appendChild(collectorRarityItem);
                }
                if (item.soccerGoal !== undefined) {
                    const soccerGoalItem = createDetailItem("Soccer Goal", item.soccerGoal);
                    if (soccerGoalItem) detailsSection.appendChild(soccerGoalItem);
                }
                card.appendChild(detailsSection);
            }

            // Add "Offer" and "Request" buttons for calculator browse mode
            if (mode === 'calculator-add') {
                const actionButtons = document.createElement('div');
                actionButtons.classList.add('calculator-item-actions');

                const offerButton = document.createElement('button');
                offerButton.textContent = 'Offer';
                offerButton.addEventListener('click', () => handleAddItemClick(item, 'offering'));

                const requestButton = document.createElement('button');
                requestButton.textContent = 'Request';
                requestButton.addEventListener('click', () => handleAddItemClick(item, 'requesting'));

                actionButtons.appendChild(offerButton);
                actionButtons.appendChild(requestButton);
                card.appendChild(actionButtons);
            }

            return card;
        }

        // Function to render items based on the active data array
        function renderItems(itemsToRender) {
            itemContainer.innerHTML = ''; // Clear existing cards
            if (itemsToRender.length === 0) {
                itemContainer.innerHTML = '<p style="text-align: center; width: 100%; margin-top: 2rem; color: #cbd5e0;">No items found matching your search.</p>';
                return;
            }
            itemsToRender.forEach(item => {
                const card = createItemCard(item, 'display'); // Pass 'display' mode
                itemContainer.appendChild(card);
            });
        }

        // Function to render items for the calculator browse section
        function renderCalculatorBrowseItems(itemsToRender) {
            calculatorItemContainer.innerHTML = ''; // Clear existing cards
            if (itemsToRender.length === 0) {
                calculatorItemContainer.innerHTML = '<p style="text-align: center; width: 100%; margin-top: 2rem; color: #cbd5e0;">No items found matching your search.</p>';
                return;
            }
            itemsToRender.forEach(item => {
                const card = createItemCard(item, 'calculator-add'); // Pass 'calculator-add' mode
                calculatorItemContainer.appendChild(card);
            });
        }

        // Function to filter items based on search term
        function filterItems(searchTerm, dataSet) {
            const lowerCaseSearchTerm = searchTerm.toLowerCase();
            return dataSet.filter(item =>
                item.name.toLowerCase().includes(lowerCaseSearchTerm) ||
                (item.demandLevel && item.demandLevel.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.currentValue && item.currentValue.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.dupedValue && item.dupedValue.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.avoided && item.avoided.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.originalPrice && item.originalPrice.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.seasonReward && item.seasonReward.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.testingAccess && item.testingAccess.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.obtainablePrice && item.obtainablePrice.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.vaultReward && item.vaultReward.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.requirement && item.requirement.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.seasonPass && item.seasonPass.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.collectorRarity && item.collectorRarity.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.soccerGoal && item.soccerGoal.toLowerCase().includes(lowerCaseSearchTerm)) ||
                (item.category && item.category.toLowerCase().includes(lowerCaseSearchTerm))
            );
        }

        // Function to set active button
        function setActiveButton(activeButton) {
            document.querySelectorAll('.category-button').forEach(button => {
                button.classList.remove('active');
            });
            activeButton.classList.add('active');
        }

        // Calculator Functions

        // Helper to check if a value string is "valid" (not N/A, Unavailable, —, Unknown)
        function isValidValue(valueString) {
            return valueString && valueString !== "N/A" && valueString !== "Unavailable" && valueString !== "—" && valueString !== "Unknown";
        }

        // Handles the click on "Offer" or "Request" buttons
        async function handleAddItemClick(item, side) {
            let selectedValue = null;
            let isDuped = false;

            // Check if the item is already in either list (by name)
            const isAlreadyInOffering = offeringItems.some(i => i.name === item.name);
            const isAlreadyInRequesting = requestingItems.some(i => i.name === item.name);

            if (isAlreadyInOffering || isAlreadyInRequesting) {
                showCustomMessage('This item is already in one of the trade lists!');
                return;
            }

            // Check if there's a valid duped value
            if (isValidValue(item.dupedValue)) {
                // Show modal to choose clean or duped
                const choice = await showValueSelectionModal(item.name, item.currentValue, item.dupedValue);
                if (choice === 'clean') {
                    selectedValue = item.currentValue;
                    isDuped = false;
                } else if (choice === 'duped') {
                    selectedValue = item.dupedValue;
                    isDuped = true;
                } else {
                    // User cancelled the modal, do not add item
                    return;
                }
            } else {
                // No duped value, use current value directly
                selectedValue = item.currentValue;
                isDuped = false;
            }

            // Proceed to add the item with the selected value
            addItemToSide(item, side, selectedValue, isDuped);
        }

        function addItemToSide(item, side, selectedValue, isDuped) {
            let targetArray = side === 'offering' ? offeringItems : requestingItems;

            if (targetArray.length < MAX_ITEMS_PER_SIDE) {
                // Create a copy of the item and add selectedPrice and isDuped
                const itemToAdd = { ...item, selectedValue: selectedValue, isDuped: isDuped };
                targetArray.push(itemToAdd);
                renderSelectedItems(side);
                updateCalculatorTotals();
            } else {
                showCustomMessage(`You can only add up to ${MAX_ITEMS_PER_SIDE} items per side.`);
            }
        }

        function removeItemFromSide(itemName, side) {
            let targetArray = side === 'offering' ? offeringItems : requestingItems;

            // Filter out the item to remove
            targetArray = targetArray.filter(item => item.name !== itemName);

            if (side === 'offering') {
                offeringItems = targetArray;
            } else {
                requestingItems = targetArray;
            }

            renderSelectedItems(side);
            updateCalculatorTotals();
        }

        function renderSelectedItems(side) {
            let targetArray = side === 'offering' ? offeringItems : requestingItems;
            let targetContainer = side === 'offering' ? offeringItemsContainer : requestingItemsContainer;
            let targetCountSpan = side === 'offering' ? offeringCountSpan : requestingCountSpan;

            targetContainer.innerHTML = ''; // Clear existing pills
            targetArray.forEach(item => {
                const pill = document.createElement('span');
                pill.classList.add('selected-item-pill');
                // Display item name and its selected value, indicating if duped
                let displayValue = item.selectedValue;
                if (item.isDuped) {
                    displayValue = `${item.selectedValue} (Duped)`;
                } else if (isValidValue(item.dupedValue)) { // If it has a duped value but clean was chosen
                    displayValue = `${item.selectedValue} (Clean)`;
                }
                pill.textContent = `${item.name} - ${displayValue}`;

                const removeBtn = document.createElement('button');
                removeBtn.classList.add('remove-item-btn');
                removeBtn.innerHTML = '&times;'; // 'x' icon
                removeBtn.addEventListener('click', () => removeItemFromSide(item.name, side));

                pill.appendChild(removeBtn);
                targetContainer.appendChild(pill);
            });
            targetCountSpan.textContent = targetArray.length;
        }

        function updateCalculatorTotals() {
            const calculateTotal = (items) => {
                return items.reduce((sum, item) => sum + parseCurrencyToNumber(item.selectedValue), 0);
            };

            const offeringTotal = calculateTotal(offeringItems);
            const requestingTotal = calculateTotal(requestingItems);
            const difference = requestingTotal - offeringTotal; // Requesting - Offering (positive if getting more, negative if offering more)

            offeringTotalSpan.textContent = `$${offeringTotal.toLocaleString()}`;
            requestingTotalSpan.textContent = `$${requestingTotal.toLocaleString()}`;

            // Update value difference
            valueDifferenceSpan.textContent = `$${difference.toLocaleString()}`;
            valueDifferenceSpan.classList.remove('positive', 'negative', 'equal');
            if (difference > 0) {
                valueDifferenceSpan.classList.add('positive');
            } else if (difference < 0) {
                valueDifferenceSpan.classList.add('negative');
            } else {
                valueDifferenceSpan.classList.add('equal');
            }
        }

        function swapSides() {
            [offeringItems, requestingItems] = [requestingItems, offeringItems];
            renderSelectedItems('offering');
            renderSelectedItems('requesting');
            updateCalculatorTotals();
        }

        function clearAll() {
            offeringItems = [];
            requestingItems = [];
            renderSelectedItems('offering');
            renderSelectedItems('requesting');
            updateCalculatorTotals();
        }

        // Custom Modal Logic for Clean/Duped selection
        function showValueSelectionModal(itemName, cleanValue, dupedValue) {
            return new Promise((resolve) => {
                modalItemName.textContent = itemName;
                modalCleanButton.textContent = `Clean (${cleanValue})`;
                modalDupedButton.textContent = `Duped (${dupedValue})`;

                // Add event listeners for the buttons
                const cleanHandler = () => {
                    valueSelectionModal.classList.remove('visible');
                    valueSelectionModal.removeEventListener('click', overlayClickHandler);
                    modalCleanButton.removeEventListener('click', cleanHandler);
                    modalDupedButton.removeEventListener('click', dupedHandler);
                    resolve('clean');
                };

                const dupedHandler = () => {
                    valueSelectionModal.classList.remove('visible');
                    valueSelectionModal.removeEventListener('click', overlayClickHandler);
                    modalCleanButton.removeEventListener('click', cleanHandler);
                    modalDupedButton.removeEventListener('click', dupedHandler);
                    resolve('duped');
                };

                // Allow clicking outside the modal to close it (and cancel selection)
                const overlayClickHandler = (event) => {
                    if (event.target === valueSelectionModal) {
                        valueSelectionModal.classList.remove('visible');
                        valueSelectionModal.removeEventListener('click', overlayClickHandler);
                        modalCleanButton.removeEventListener('click', cleanHandler);
                        modalDupedButton.removeEventListener('click', dupedHandler);
                        resolve(null); // Resolve with null if cancelled
                    }
                };

                modalCleanButton.addEventListener('click', cleanHandler);
                modalDupedButton.addEventListener('click', dupedHandler);
                valueSelectionModal.addEventListener('click', overlayClickHandler);

                valueSelectionModal.classList.add('visible');
            });
        }

        // Custom Message Box (for non-confirm alerts)
        function showCustomMessage(message) {
            customMessageBox.textContent = message;
            customMessageBox.style.display = 'block';
            setTimeout(() => { customMessageBox.style.opacity = 1; }, 10); // Small delay for transition
            setTimeout(() => {
                customMessageBox.style.opacity = 0;
                customMessageBox.addEventListener('transitionend', () => { customMessageBox.style.display = 'none'; }, { once: true });
            }, 3000); // Hide after 3 seconds
        }


        // Event listeners for the main search bar
        searchBar.addEventListener('input', (event) => {
            const filteredItems = filterItems(event.target.value, (currentCategoryName === "All") ? allData : currentActiveData);
            renderItems(filteredItems);
        });

        // Event listener for Calculator search bar
        calculatorSearchBar.addEventListener('input', (event) => {
            const filteredItems = filterItems(event.target.value, allData); // Always filter from allData for calculator browse
            renderCalculatorBrowseItems(filteredItems);
        });

        // Event listener for Home button
        homeButton.addEventListener('click', () => {
            showSection('home-about-section');
            setActiveButton(homeButton);
        });

        // Event listener for All button
        allButton.addEventListener('click', () => {
            currentActiveData = allData; // Use the combined and sorted data
            currentCategoryName = "All";
            categoryTitle.textContent = "All Items (Most Expensive First)";
            searchBar.value = ''; // Clear search bar
            renderItems(currentActiveData);
            showSection('trading-content-section');
            setActiveButton(allButton);
        });

        // Event listener for Vehicles button
        vehiclesButton.addEventListener('click', () => {
            currentActiveData = vehiclesData;
            currentCategoryName = "Vehicle";
            categoryTitle.textContent = "Vehicle Collection";
            searchBar.value = ''; // Clear search bar
            renderItems(currentActiveData);
            showSection('trading-content-section');
            setActiveButton(vehiclesButton);
        });

        // Event listener for Textures button
        texturesButton.addEventListener('click', () => {
            currentActiveData = texturesData;
            currentCategoryName = "Texture";
            categoryTitle.textContent = "Texture Collection";
            searchBar.value = ''; // Clear search bar
            renderItems(currentActiveData);
            showSection('trading-content-section');
            setActiveButton(texturesButton);
        });

        // Event listener for Rims button
        rimsButton.addEventListener('click', () => {
            currentActiveData = rimsData;
            currentCategoryName = "Rim";
            categoryTitle.textContent = "Rim Collection";
            searchBar.value = ''; // Clear search bar
            renderItems(currentActiveData);
            showSection('trading-content-section');
            setActiveButton(rimsButton);
        });

        // Event listener for Spoilers button
        spoilersButton.addEventListener('click', () => {
            currentActiveData = spoilersData;
            currentCategoryName = "Spoiler";
            categoryTitle.textContent = "Spoiler Collection";
            searchBar.value = ''; // Clear search bar
            renderItems(currentActiveData);
            showSection('trading-content-section');
            setActiveButton(spoilersButton);
        });

        // Event listener for Hyperchromes button
        hyperchromesButton.addEventListener('click', () => {
            currentActiveData = hyperchromesData;
            currentCategoryName = "Hyperchrome";
            categoryTitle.textContent = "Hyperchrome Collection";
            searchBar.value = ''; // Clear search bar
            renderItems(currentActiveData);
            showSection('trading-content-section');
            setActiveButton(hyperchromesButton);
        });

        // Event listener for the new Calculator button
        calculatorButton.addEventListener('click', () => {
            showSection('calculator-section');
            setActiveButton(calculatorButton);
            renderCalculatorBrowseItems(allData); // Initial render for calculator browse
        });

        // Event listeners for Calculator action buttons
        swapSidesButton.addEventListener('click', swapSides);
        clearAllButton.addEventListener('click', clearAll);

        // Event listener for the top Discord button
        discordButtonTop.addEventListener('click', () => {
            window.open('https://discord.gg/g6mnGDvQ', '_blank');
        });

        // Initial render: show home page by default
        document.addEventListener('DOMContentLoaded', () => {
            showSection('home-about-section'); // Show combined section by default
            setActiveButton(homeButton);
        });
    </script>
</body>
</html>
